<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Definir Disponibilidad - Panel Médico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-green': { light: '#6EE7B7', DEFAULT: '#10B981', dark: '#047857' },
                        'brand-gray': { light: '#F3F4F6', DEFAULT: '#9CA3AF', dark: '#4B5563' },
                        'brand-blue': { light: '#DBEAFE', DEFAULT: '#3B82F6', dark: '#1D4ED8' },
                        'brand-red': { light: '#FEE2E2', DEFAULT: '#EF4444', dark: '#B91C1C' },
                    }
                }
            }
        }
    </script>
    <style> 
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; } 
        .modal-overlay { 
            z-index: 60; /* Navbar puede ser z-50 */
        }
        /* No se necesitan las reglas CSS vacías que causaban error */
    </style>
</head>
<body class="bg-brand-gray-light min-h-screen">

    <nav class="bg-brand-green-dark shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="panel_medico_dashboard.html" class="text-2xl font-bold text-white">Centro Médico</a>
                    <span class="ml-4 text-green-100 hidden sm:inline">- Dr. Morales / Definir Disponibilidad</span>
                </div>
                <div>
                    <a href="panel_medico_dashboard.html" class="text-sm text-green-100 hover:bg-brand-green hover:text-white px-3 py-2 rounded-md transition-colors">
                        &larr; Volver al Panel
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-16">
        <div class="max-w-4xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-2xl">
            
            <header class="mb-8">
                <h1 class="text-2xl md:text-3xl font-bold text-brand-green-dark">Configurar Mis Horarios de Atención</h1>
                <p class="text-brand-gray-DEFAULT mt-1">Seleccione un día y luego marque los bloques horarios en los que estará disponible.</p>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-semibold text-brand-gray-dark mb-3">Junio 2025</h3>
                    <div class="grid grid-cols-7 gap-1 text-center text-sm p-3 bg-gray-50 rounded-lg shadow">
                        <div class="font-medium text-brand-gray-dark py-1">Lu</div>
                        <div class="font-medium text-brand-gray-dark py-1">Ma</div>
                        <div class="font-medium text-brand-gray-dark py-1">Mi</div>
                        <div class="font-medium text-brand-gray-dark py-1">Ju</div>
                        <div class="font-medium text-brand-gray-dark py-1">Vi</div>
                        <div class="font-medium text-brand-gray-dark py-1">Sá</div>
                        <div class="font-medium text-brand-gray-dark py-1">Do</div>
                        
                        <div class="p-2 text-gray-400"></div> <div class="p-2 text-gray-400"></div> <div class="p-2 text-gray-400"></div> <div class="p-2 text-gray-400"></div> <div class="p-2 text-gray-400"></div> <div class="p-2 text-gray-400"></div>
                        <div class="p-2 border rounded-md text-gray-500 bg-gray-100 cursor-not-allowed">1</div>

                        <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green border-brand-green">2</button>
                        <button type="button" class="calendar-day selected p-2 border rounded-md bg-brand-green text-white font-semibold hover:bg-brand-green-dark focus:ring-2 focus:ring-brand-green">3</button> <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green">4</button>
                        <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green border-brand-green">5</button>
                        <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green">6</button>
                        <div class="p-2 border rounded-md text-gray-500 bg-gray-100 cursor-not-allowed">7</div>
                        <div class="p-2 border rounded-md text-gray-500 bg-gray-100 cursor-not-allowed">8</div>

                        <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green">9</button>
                        <button type="button" class="calendar-day p-2 border rounded-md hover:bg-green-50 focus:bg-green-100 focus:ring-2 focus:ring-brand-green border-brand-green">10</button>
                        <div class="p-2 border rounded-md text-gray-400">...</div> <div class="p-2 border rounded-md text-gray-400">...</div> <div class="p-2 border rounded-md text-gray-400">...</div> <div class="p-2 border rounded-md text-gray-400">...</div> <div class="p-2 border rounded-md text-gray-400">...</div>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">Los días con borde verde (o resaltados) ya tienen alguna configuración. Haz clic en un día para ver/editar sus horarios.</p>
                </div>

                <div class="md:col-span-2">
                    <h3 class="text-lg font-semibold text-brand-gray-dark mb-1">Horarios para: <span id="selectedDayTitle" class="text-brand-green font-bold">Martes, 3 de Junio de 2025</span></h3>
                    <p class="text-xs text-gray-500 mb-4">Haga clic en un bloque para marcarlo como disponible (verde) o no disponible (gris).</p>
                    
                    <div class="space-y-3">
                        <div>
                            <p class="text-sm font-medium text-brand-gray-dark mb-2">Horarios (07:00 - 19:30)</p>
                            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2">
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">07:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">07:30</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">08:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">08:30</button>
                                
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">09:00</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">09:30</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">10:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">10:30</button>
                                
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">11:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">11:30</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">12:00</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">12:30</button>

                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">13:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">13:30</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">14:00</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">14:30</button>

                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">15:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">15:30</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">16:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">16:30</button>

                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">17:00</button>
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">17:30</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">18:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">18:30</button>
                                
                                <button type="button" class="time-slot-toggle unavailable p-2.5 border rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">19:00</button>
                                <button type="button" class="time-slot-toggle available p-2.5 border rounded-md text-sm font-medium bg-green-500 text-white hover:bg-green-600">19:30</button>
                                </div>
                        </div>
                    </div>

                    <div class="mt-8 text-right">
                        <button type="button" id="saveAvailabilityBtn" class="text-white bg-brand-green-dark hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-base px-8 py-3 transition-colors duration-300 shadow-md hover:shadow-lg">
                            Guardar Cambios de Disponibilidad
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <div id="availabilitySuccessModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden modal-overlay">
        <div class="bg-white p-6 md:p-8 rounded-xl shadow-2xl text-center max-w-md mx-auto">
            <svg class="w-16 h-16 text-brand-green mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <h3 class="text-xl font-medium text-brand-green-dark mb-3">¡Guardado!</h3>
            <p class="text-sm text-brand-gray-dark mb-6">Tu disponibilidad ha sido actualizada correctamente.</p>
            <button type="button" id="closeAvailabilitySuccessModalBtn" class="w-full sm:w-auto bg-brand-green hover:bg-brand-green-dark text-white font-medium py-2.5 px-6 rounded-lg">Aceptar</button>
        </div>
    </div>

    <footer class="text-center text-sm text-brand-gray-DEFAULT py-8 mt-12 md:mt-16">
        &copy; <span id="currentYear"></span> Centro Médico Integral. Todos los derechos reservados.
    </footer>
    <script>
        const currentYearEl = document.getElementById('currentYear');
        if (currentYearEl) {
             currentYearEl.textContent = new Date().getFullYear();
        }

        const saveAvailabilityBtn = document.getElementById('saveAvailabilityBtn');
        const availabilitySuccessModal = document.getElementById('availabilitySuccessModal');
        const closeAvailabilitySuccessModalBtn = document.getElementById('closeAvailabilitySuccessModalBtn');

        if (saveAvailabilityBtn && availabilitySuccessModal) {
            saveAvailabilityBtn.addEventListener('click', function() {
                availabilitySuccessModal.classList.remove('hidden');
            });
        }
        if (closeAvailabilitySuccessModalBtn && availabilitySuccessModal) {
            closeAvailabilitySuccessModalBtn.addEventListener('click', function() {
                availabilitySuccessModal.classList.add('hidden');
            });
        }
        
        document.querySelectorAll('.time-slot-toggle').forEach(button => {
            button.addEventListener('click', function() {
                const isAvailable = this.classList.contains('available');
                if (isAvailable) {
                    this.classList.remove('available', 'bg-green-500', 'text-white', 'hover:bg-green-600');
                    this.classList.add('unavailable', 'bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                } else {
                    this.classList.remove('unavailable', 'bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                    this.classList.add('available', 'bg-green-500', 'text-white', 'hover:bg-green-600');
                }
            });
        });

        const calendarDays = document.querySelectorAll('.calendar-day');
        const selectedDayTitleEl = document.getElementById('selectedDayTitle'); // Corregido para obtener el elemento correcto
        const dayNames = ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"];

        calendarDays.forEach(dayButton => {
            if (dayButton.classList.contains('selected') && selectedDayTitleEl) { // Inicializar el título con el día ya seleccionado
                 const dayNumber = parseInt(dayButton.textContent);
                 const date = new Date(2025, 5, dayNumber); // Mes 5 es Junio (0-indexado)
                 const dayName = dayNames[date.getDay()];
                 selectedDayTitleEl.textContent = dayName + ", " + dayNumber + " de Junio de 2025";
            }

            if (!dayButton.disabled) { 
                 dayButton.addEventListener('click', function() {
                    calendarDays.forEach(btn => {
                        btn.classList.remove('selected', 'bg-brand-green', 'text-white', 'font-semibold');
                    });
                    this.classList.add('selected', 'bg-brand-green', 'text-white', 'font-semibold');
                    
                    if (selectedDayTitleEl) {
                        const dayNumber = parseInt(this.textContent);
                        const date = new Date(2025, 5, dayNumber); 
                        const dayName = dayNames[date.getDay()];
                        selectedDayTitleEl.textContent = dayName + ", " + dayNumber + " de Junio de 2025";
                    }
                });
            }
        });

        if(availabilitySuccessModal) {
            availabilitySuccessModal.addEventListener('click', function(event) {
                if (event.target === availabilitySuccessModal) {
                    availabilitySuccessModal.classList.add('hidden');
                }
            });
        }
    </script>
</body>
</html>